---
import { CONTACTS } from '@utils/data'
import { ContactGroup, type Social } from '@utils/types'
import FooterGroup from './FooterGroup.astro'
import Section from './Section.astro'
import packageJson from '../../package.json'
import Iconed from './Iconed.astro'
import { GitHub } from 'react-feather'
import Link from './Link.astro'

// eslint-disable-next-line @typescript-eslint/consistent-type-definitions
export interface Props {
  class?: string
}

const { class: className, ...attrs } = Astro.props

const allContacts = Object.keys(CONTACTS) as Social[]

const socialContacts = allContacts.filter(
  (key) => CONTACTS[key].group === ContactGroup.Social,
)
const codeContacts = allContacts.filter(
  (key) => CONTACTS[key].group === ContactGroup.Code,
)
const otherContacts = allContacts.filter(
  (key) => CONTACTS[key].group === ContactGroup.Other,
)
---

<footer class:list={['mt-8 w-full', className]} {...attrs}>
  <Section class="flex flex-wrap justify-evenly pb-4 text-primary">
    <FooterGroup contactGroup={otherContacts} />
    <FooterGroup contactGroup={socialContacts} />
    <FooterGroup contactGroup={codeContacts} />
  </Section>
  <Section class="flex flex-wrap justify-center gap-4 pb-2">
    <Link
      isExternal
      href={packageJson.repository.url}
      title="Github repository">
      <Iconed>
        <GitHub slot="icon" />
        <span>Site source code</span>
      </Iconed>
    </Link>
  </Section>
  <slot />
</footer>
